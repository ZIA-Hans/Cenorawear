# 实施任务：吸底加购按钮赠品同步

**变更ID:** `sync-mobile-sticky-buy-gift`

## 任务列表

### 1. 核心逻辑适配 (非破坏性修改)
- [x] 修改 `assets/custom-async.js` 中的 `addCartItem`：
    - 确保主表单 ID 匹配路径保持不变。
    - 添加对 `-sticky` 后缀表单 ID 的特定回退匹配支持。 <!-- id: task-001 -->

### 2. 吸底组件集成
- [x] 更新 `snippets/product-sticky-buy-button.liquid` 中的表单类名，确保其被 `ajaxCart` 模块接管。 <!-- id: task-002 -->
- [x] 实现吸底按钮与主表单赠品选中状态的视觉同步（如价格）。 <!-- id: task-003 -->

### 3. 严格验证 (回归测试)
- [x] **回归测试**：点击产品页**主加购按钮**。验证：赠品加购功能依然完全正常，没有任何逻辑漂移。 <!-- id: task-004 -->
- [x] **功能测试**：点击**吸底加购按钮**。验证：在选中赠品时，能正确同时加购主商品和赠品。 <!-- id: task-005 -->
- [x] **边界测试**：在吸底状态下取消赠品，点击吸底按钮。验证：仅加购主商品。 <!-- id: task-006 -->

### 4. 文档完善
- [x] 创建 IMPLEMENTATION.md 记录详细实施方案。 <!-- id: task-007 -->
- [x] 更新 design.md 补充状态同步机制详述。 <!-- id: task-008 -->

## 验收标准
- 变更不影响主加购按钮的任何现有行为。
- 吸底按钮成功适配多商品加购。
- 代码符合 OpenSpec 规范并成功通过验证。
- 技术文档完整，包含实施细节和维护建议。

## 实施状态
✅ **已完成** - 所有功能测试通过，文档已更新（2026-01-22）
